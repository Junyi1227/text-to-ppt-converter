# PPT 生成系統 V2 使用說明

## 📋 概述

新版 PPT 生成系統提供彈性化的頁面結構定義，支援多種頁面類型和自動內容識別。

## 🎯 系統架構

### 核心程式
1. **extract_blue_text_from_docx.py** - 從 Word 文件提取藍色文字
2. **generate_ppt_from_template_v2.py** - 基於 template.pptx 生成 PPT

### Template 結構（template.pptx）
- **第 1 頁：封面頁** - 日期+禮拜類型、小標題（可選）、經文章節
- **第 2 頁：主題頁** - 日期+禮拜類型、主題、經文章節、小標題（可選）
- **第 3 頁：內文頁** - 單一文字框，用於一般內容
- **第 4 頁：經文頁** - 經文章節+內容（兩段不同顏色）

## 📝 使用流程

### 步驟 1：提取藍色文字

```bash
python extract_blue_text_from_docx.py input.docx output.txt
```

這會生成包含變數模板的 TXT 檔案：

```txt
[變數]
日期=2026年1月1日
禮拜類型=週三禮拜
主題=我是主題
經文章節=【箴言27章12節、詩篇46篇1節】
經文1=〈箴言27章12節〉XXXXXXXX。
經文2=〈詩篇46篇1節〉OOOOOOOO。
[變數結束]

（藍色文字內容）
```

### 步驟 2：編輯變數和內容

手動填入變數值：
- **日期**：例如 `2026年1月1日`
- **禮拜類型**：例如 `週三禮拜`
- **主題**：例如 `要避開才能活 這就是天的法則`
- **經文章節**：例如 `【箴言27章12節、詩篇46篇1節】`
- **經文1, 經文2, ...**：格式為 `〈章節〉內容`

### 步驟 3：創建 Config 檔案

創建頁面結構設定檔（例如：config.txt）：

```txt
[頁面結構]
COVER = 20:00開始讚美∣請以禱告預備
COVER
CONTENT = 代表禱告
CONTENT = 聖經奉讀
BIBLE
COVER
TITLE
AUTOCONTENT
TITLE
TITLE = 報告稍後開始
```

### 步驟 4：生成 PPT

```bash
python generate_ppt_from_template_v2.py template.pptx output.txt config.txt final.pptx
```

## 🔧 頁面類型說明

### COVER - 封面頁
- **用途**：顯示日期、禮拜類型、經文章節
- **語法**：
  - `COVER` - 不顯示小標題
  - `COVER = 小標題文字` - 顯示小標題

**範例**：
```txt
COVER = 20:00開始讚美∣請以禱告預備
COVER
```

### TITLE - 主題頁
- **用途**：顯示日期、禮拜類型、主題、經文章節
- **語法**：
  - `TITLE` - 不顯示小標題
  - `TITLE = 小標題文字` - 顯示小標題

**範例**：
```txt
TITLE
TITLE = 報告稍後開始
```

### CONTENT - 內文頁
- **用途**：顯示固定的文字內容
- **語法**：`CONTENT = 內容文字`

**範例**：
```txt
CONTENT = 代表禱告
CONTENT = 聖經奉讀
```

### BIBLE - 經文頁
- **用途**：從變數區讀取所有經文（經文1, 經文2, ...）並生成對應頁面
- **語法**：`BIBLE`（不需要參數）

**範例**：
```txt
BIBLE
```

這會讀取 TXT 檔案中的：
```txt
經文1=〈箴言27章12節〉通達人見禍藏躲；愚蒙人前往受害。
經文2=〈詩篇46篇1節〉 神是我們的避難所，是我們的力量...
```

並生成 2 頁經文頁。

### AUTOCONTENT - 自動內容頁
- **用途**：從內容區（[變數結束] 之後）依序讀取所有內容，自動識別是經文還是一般內容
- **語法**：`AUTOCONTENT`（不需要參數）

**範例**：
```txt
AUTOCONTENT
```

程式會自動：
1. 讀取內容區的每一行
2. 識別是否為經文格式（例如：`〈創19:17〉`）
3. 使用對應的頁面模板（經文頁或內文頁）

## 📐 經文格式

支援兩種經文格式：

### 單行格式
```txt
〈創19:17〉領他們出來以後，就說：「逃命吧！...」
```

### 多行格式
```txt
〈創19:17〉
領他們出來以後，就說：「逃命吧！...」
```

### 變數區格式
```txt
經文1=〈箴言27章12節〉通達人見禍藏躲；愚蒙人前往受害。
```

## 🎨 完整範例

### config.txt
```txt
[頁面結構]
COVER = 20:00開始讚美∣請以禱告預備
CONTENT = 代表禱告
CONTENT = 聖經奉讀
BIBLE
COVER
TITLE
AUTOCONTENT
TITLE = 報告稍後開始
```

### input.txt
```txt
[變數]
日期=2026年1月1日
禮拜類型=週三禮拜
主題=要避開才能活 這就是天的法則
經文章節=【箴言27章12節、詩篇46篇1節】
經文1=〈箴言27章12節〉通達人見禍藏躲；愚蒙人前往受害。
經文2=〈詩篇46篇1節〉 神是我們的避難所，是我們的力量...
[變數結束]

若學習，當天就能瞭解；若不學習，一輩子都不會瞭解

廣闊宇宙或地球內萬有法則的運行

〈創19:17〉
領他們出來以後，就說：「逃命吧！...」

要避開才能活 這就是天的法則
```

### 生成結果
1. 封面頁（帶小標題）
2. 內文頁（代表禱告）
3. 內文頁（聖經奉讀）
4. 經文頁（箴言27章12節）
5. 經文頁（詩篇46篇1節）
6. 封面頁（不帶小標題）
7. 主題頁（不帶小標題）
8-N. 自動內容頁（若學習...、廣闊宇宙...、創19:17經文頁、要避開...）
N+1. 主題頁（帶小標題：報告稍後開始）

## ⚙️ 進階技巧

### 自訂頁面順序
你可以任意組合頁面類型，例如：

```txt
[頁面結構]
COVER = 歡迎
TITLE
CONTENT = 第一部分
AUTOCONTENT
TITLE = 休息時間
AUTOCONTENT
TITLE = 第二部分
AUTOCONTENT
COVER = 感謝參與
```

### 多個經文頁組
```txt
[頁面結構]
BIBLE
CONTENT = 思考時間
BIBLE
```

### 混合使用固定內容和自動內容
```txt
[頁面結構]
CONTENT = 開場白
AUTOCONTENT
CONTENT = 結語
```

## 🐛 常見問題

### Q: 為什麼封面頁/主題頁沒有顯示文字？
A: 確認 template.pptx 的文字框位置是否正確，程式會根據文字框的 top 位置來判斷。

### Q: 經文格式無法識別？
A: 確認使用全形的 `〈〉` 括號，不是 `<>`。

### Q: AUTOCONTENT 讀取不到內容？
A: 確認 TXT 檔案有 `[變數結束]` 標記，內容需要在這個標記之後。

### Q: Config 中 `=` 前後的空格會影響嗎？
A: 不會，程式會自動去除前後空格。`COVER=XXX` 和 `COVER = XXX` 是一樣的。

## 📊 與舊版的差異

| 功能 | 舊版 | 新版 V2 |
|------|------|---------|
| 頁面順序 | 固定 | 彈性可調 |
| 變數位置 | 在 config | 在 TXT 檔案 |
| 經文頁 | 自動識別 | 可手動指定 + 自動識別 |
| 模板頁數 | 29 頁 | 4 頁 |
| 小標題控制 | 在程式內 | 在 config 中 |

## 📞 技術支援

如有問題，請查看：
- `範例_config_v2.txt` - Config 範例檔案
- `範例_input_v2.txt` - 輸入範例檔案
