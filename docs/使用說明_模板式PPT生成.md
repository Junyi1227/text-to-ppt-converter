# 使用模板生成 PPT - 完整教學

## 🎯 適用情境

當你有固定格式的 PPT 模板，每次只需要：
- 更新日期、標題、經文
- 插入從 Word 提取的藍色文字內容

## 📋 工作流程

### 步驟 1：提取藍色文字

從 Word 文件中提取所有藍色文字：

```bash
python extract_blue_text_simple.py 20251231.docx
```

這會生成：`20251231_blue_text.txt`（純文字清單，每段一行）

**範例輸出：**
```
若學習，當天就能瞭解；
若不學習，一輩子都不會瞭解
廣闊宇宙或地球內萬有法則的運行，是不能中斷的，
...
```

---

### 步驟 2：準備配置檔

建立配置檔（例如：`20251231_config.txt`），填入固定內容：

```txt
# PPT 生成設定檔

# 日期（會出現在第1、7、28、29頁）
DATE: 2025年12月31日

# 主標題（會出現在第28、29頁）
TITLE: 要避開才能活 這就是天的法則

# 第一段經文章節和內容（第5頁）
VERSE_REF_1: 箴言27章12節
VERSE_TEXT_1: 通達人見禍藏躲；愚蒙人前往受害。

# 第二段經文章節和內容（第6頁）
VERSE_REF_2: 詩篇46篇1節
VERSE_TEXT_2: 神是我們的避難所，是我們的力量，是我們在患難中隨時的幫助。

# 經文章節簡短版本（會出現在第1、7、28、29頁）
VERSE_REFS: 箴言27章12節、詩篇46篇1節

# 禮拜類型（可選，預設：週三禮拜）
SERVICE_TYPE: 週三禮拜

# 開始時間（可選，第1頁）
START_TIME: 20:00開始讚美∣請以禱告預備
```

**配置檔格式說明：**
- 使用 `KEY: VALUE` 格式
- `#` 開頭為註解行
- 空行會被忽略

---

### 步驟 3：生成 PPT

使用模板和配置檔生成新的 PPT：

```bash
python generate_ppt_from_template.py \
  "20251231 Wed.pptx" \
  20251231_blue_text.txt \
  20251231_config.txt \
  output.pptx
```

**參數說明：**
1. `20251231 Wed.pptx` - 模板檔案
2. `20251231_blue_text.txt` - 藍色文字清單
3. `20251231_config.txt` - 配置檔
4. `output.pptx` - 輸出檔名（可選）

---

## 📊 生成的 PPT 結構

### 固定頁面（前 7 頁）
- **第 1 頁**：封面（日期、經文章節）
- **第 2 頁**：（保持原樣）
- **第 3 頁**：代表禱告
- **第 4 頁**：聖經奉讀
- **第 5 頁**：第一段經文（從配置檔讀取）
- **第 6 頁**：第二段經文（從配置檔讀取）
- **第 7 頁**：標題頁（日期、經文章節）

### 動態內容頁（第 8 頁開始）
- 每段藍色文字生成一張投影片
- 使用模板第 8 頁的樣式
- 如果有 N 段藍色文字，就會有 N 張投影片

### 固定頁面（最後 2 頁）
- **倒數第 2 頁**：結束頁（日期、標題、經文章節）
- **最後 1 頁**：結束頁 + 報告稍後開始

---

## 🎨 模板要求

你的模板 PPT 需要包含：

1. **前 7 頁**：固定格式頁面
2. **第 8 頁**：內容頁樣式（會用來複製給所有藍色文字）
3. **最後 2 頁**：結束頁

程式會：
- 複製前 7 頁，替換變數（日期、經文等）
- 使用第 8 頁作為樣式，為每段藍色文字建立新頁
- 複製最後 2 頁，替換變數

---

## 📝 完整範例

假設你有以下檔案：
- `20251231.docx` - Word 文件（包含藍色文字）
- `20251231 Wed.pptx` - PPT 模板

**步驟 1：提取藍色文字**
```bash
python extract_blue_text_simple.py 20251231.docx
# 生成 20251231_blue_text.txt
```

**步驟 2：建立配置檔**
```bash
# 建立 20251231_config.txt，填入日期、標題、經文
```

**步驟 3：生成 PPT**
```bash
python generate_ppt_from_template.py \
  "20251231 Wed.pptx" \
  20251231_blue_text.txt \
  20251231_config.txt \
  "20251231_output.pptx"
```

**結果：**
- ✅ 生成 `20251231_output.pptx`
- 📊 包含：7 張固定頁 + N 張內容頁 + 2 張結束頁

---

## ⚠️ 注意事項

### 1. 檔案編碼
所有文字檔案必須使用 **UTF-8 編碼**

### 2. 模板格式
- 模板必須是 `.pptx` 格式
- 確保模板已經包含所有樣式和背景

### 3. 配置檔變數
程式會在以下頁面替換變數：
- 第 1、7、28、29 頁：日期、經文章節
- 第 5、6 頁：經文內容
- 第 28、29 頁：主標題

### 4. 文字長度
- 藍色文字每段建議不超過 150 字
- 經文內容每段建議不超過 200 字
- 過長的文字可能會超出投影片範圍

---

## 🔧 進階設定

### 自訂模板樣式

如果你想修改內容頁的樣式，編輯模板的第 8 頁：
- 調整文字框位置和大小
- 修改字體、大小、顏色
- 變更背景樣式

程式會自動套用這些設定到所有內容頁。

### 批次處理

處理多個 Word 文件：

```bash
# Mac/Linux
for file in *.docx; do
    python extract_blue_text_simple.py "$file"
    # 手動編輯配置檔
    python generate_ppt_from_template.py "template.pptx" "${file%.docx}_blue_text.txt" "${file%.docx}_config.txt"
done
```

---

## ❓ 常見問題

### Q: 生成的 PPT 頁數不對？
**A**: 檢查藍色文字檔案，確認每行是一段內容。空行會被忽略。

### Q: 配置檔的變數沒有替換？
**A**: 
1. 檢查配置檔格式：`KEY: VALUE`（注意冒號後面有空格）
2. 確認變數名稱正確（區分大小寫）
3. 檢查檔案編碼是否為 UTF-8

### Q: 可以修改固定頁面的數量嗎？
**A**: 可以，編輯 `generate_ppt_from_template.py` 中的 `generate()` 函數，修改複製頁面的範圍。

### Q: 內容頁的樣式不正確？
**A**: 確認模板的第 8 頁樣式是你想要的。程式會複製第 8 頁的文字框格式。

---

## 📚 相關文件

- [範例配置檔](../examples/範例_config.txt)
- [Python 安裝指南](Python_安裝指南.txt)
- [Word 轉 PPT 使用範例](../examples/使用範例_Word轉PPT.md)

---

## 🎉 完成！

現在你可以快速從 Word 文件生成格式統一的 PPT 簡報了！
